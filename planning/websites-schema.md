# Websites Schema (`websites` Collection)

This document defines the structure of the `websites` collection in Firestore.  This collection stores information about the websites managed by Jezweb for its client *organisations*.

## Collection: `websites`

Each document in the `websites` collection represents a single website.

## Document Structure (Interface):

```typescript
interface Website {
  websiteId: string;          // Unique identifier (auto-generated by Firestore)
  organisationId: string;     // Reference to the 'organisationId' in the 'organisations' collection
  domain: string;             // The website's primary domain name (e.g., "example.com")
  status: string;          // Website status ("active", "inactive", "development", "staging", "suspended")
  hosting: {
    provider: string;      // Hosting provider (e.g., "Rocket", "AWS", "Cloudways", "cPanel", "Other")
    serverId?: string;    // Optional: Server ID or name
    phpVersion?: string;   // Optional: PHP version
    ipAddress?: string;   // Optional: IP address
    username?: string;    // Optional: Hosting username (store securely!)
    notes?: string;       // Optional: Notes about hosting configuration
    expiryDate?: string;    // Optional.
  };
  cms: {
    type: string;          // CMS type (e.g., "WordPress", "Shopify", "Joomla", "Custom")
    version?: string;     // Optional: CMS version
    plugins?: string[];    // Optional: Array of plugin IDs (references to a 'plugins' collection, if you have one)
    theme?: { // Optional
        name?: string;
        version?: string;
        childTheme?: string;
    };
    adminUrl?: string;    // Optional: URL to the website's admin area
    notes?: string;       // Optional: Technical notes about the CMS configuration
  };
    ga: { // Optional
        gaId?: string;
        gtmId?: string;
    },
   dns: { // Optional
        hosting?: string;
        web_smtp?: string;
    },
    domain_hosting: { // Optional
        hosting?: string;
        registrar?: string;
        expiryDate?: string;
        autoRenew?: boolean;
        domainContact?: string; // Optional ref to contact
    },
    sslCertificate?: { // Optional
        expiryDate?: string;
        issuer?: string;
    },
  notes?: string;          // Optional: General notes about the website
    backups?: {
        provider?: string;
        frequency?: string;
        lastBackup?: string;
        dropboxUrl?: string;
    }
  createdAt: firebase.firestore.Timestamp;
  updatedAt: firebase.firestore.Timestamp;
}
```

**Key Fields and Considerations (Focusing on Data Structure):**

*   **`websiteId`:** Auto-generated unique ID.
*   **`organisationId`:** *Crucially*, this now references the `organisationId` in the `organisations` collection. This is how you link a website to the client organisation.
*   **`domain`:**  The primary domain name.
*   **`status`:**  The website's status (e.g., "active," "inactive," "development," "staging," "suspended").
*   **`hosting`:**  A nested object containing information about the website's hosting:
    *   **`provider`:** (e.g., "Rocket," "AWS," "Cloudways," "cPanel," "Other"). You might manage this list of providers using the `options` collection (similar to dropdown options).
    *   **`serverId`:** (Optional)
    *   **`phpVersion`:** (Optional)
    *   **`ipAddress`:** (Optional)
    *   **`username`:** (Optional - *Store Securely!*) Use Firebase Secrets Manager if you store sensitive credentials.
    *   **`notes`:** (Optional)
*   **`cms`:** A nested object containing information about the website's Content Management System:
    *   **`type`:** (e.g., "WordPress," "Shopify," "Joomla," "Custom"). Again, consider managing this list via the `options` collection.
    *   **`version`:** (Optional)
    *   **`plugins`:** (Optional) An array of plugin IDs.  *If* you decide to have a separate `plugins` collection (for managing plugin development – as in the Plugin Hub), this would be an array of references to that collection.  If not, you might store plugin names directly here (less normalized, but simpler).
        *   **`theme`:** Theme details.
    *   **`adminUrl`:** (Optional)
    *   **`notes`:** (Optional)
* **`ga`**: Google analytics details.
* **`dns`:** DNS details.
* **`domain_hosting`:** Details.
* **`sslCertificate`**: Details.
*   **`notes`:** (Optional) General notes.
* **`createdAt`** and **`updatedAt`**: Timestamps
* **`backups`**: backups details.

**Relationships:**

*   **`websites` ↔️ `organisations`:** (via `organisationId`) - This is the *primary* relationship, linking websites to client organisations.
*   **`websites` ↔️ `plugins`:** (Optional, via `cms.plugins` - *if* you have a separate `plugins` collection)
*   **`websites` ↔️ `supportTickets`:** (via a `websiteId` field in the `supportTickets` collection – we'll define this later)
*   **`websites` ↔️ `projects`:** (via a `websiteId` field in the `projects` collection)

**Example JSON Record:**

```json
{
  "websiteId": "website001",
  "organisationId": "org123",
  "domain": "exampleclient.com.au",
  "status": "active",
  "hosting": {
    "provider": "Cloudways",
    "serverId": "server789",
    "phpVersion": "8.2",
    "ipAddress": "192.0.2.1",
    "notes": "Standard configuration"
  },
  "cms": {
    "type": "WordPress",
    "version": "6.5.1",
    "plugins": [],
     "theme": {
           "name": "Astra",
          "version": "4.6.8",
            "childTheme": null
      },
    "adminUrl": "https://exampleclient.com.au/wp-admin"
  },
    "ga": {
        "gaId": "UA-12345678-1",
        "gtmId": "GTM-XXXXXXX"
    },
    "dns": {
        "hosting": "Cloudflare",
        "web_smtp": "SendGrid"
    },
        "domain_hosting": {
          "hosting": "Namecheap",
        "registrar": "GoDaddy",
        "expiryDate": "2026-05-20",
        "autoRenew": true,
        "domainContact": "contact001"
    },
    "sslCertificate": {
        "expiryDate": "2025-12-31",
        "issuer": "Let's Encrypt"
    },
  "notes": "Standard WordPress setup.",
  "createdAt": "2024-03-12T23:00:00Z",
  "updatedAt": "2024-03-12T23:00:00Z",
  "backups": {
        "provider": "UpdraftPlus",
        "frequency": "Daily",
        "lastBackup": "2025-02-28T01:00:00Z",
          "dropboxUrl": null
    }
}
```
